// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define(["./basePortalUrlUtils"],function(q){function k(a,c){function d(b,l){var e,h,m="widgetOnScreen"===b;if(a[b]){if(a[b].groups)for(e=0;e<a[b].groups.length;e++){var n=a[b].groups[e];l(n,{index:e,isWidget:!1,groupId:n.id,isThemeWidget:!1,isOnScreen:m});if(a[b].groups[e].widgets)for(h=0;h<a[b].groups[e].widgets.length;h++){var g=a[b].groups[e].widgets[h];l(g,{index:h,isWidget:!0,groupId:n.id,isThemeWidget:g.uri&&-1<g.uri.indexOf("themes/"+a.theme.name),isOnScreen:m})}}if(a[b].widgets)for(e=0;e<
a[b].widgets.length;e++)g=a[b].widgets[e],l(a[b].widgets[e],{index:e,isWidget:!0,groupId:b,isThemeWidget:g.uri&&-1<g.uri.indexOf("themes/"+a.theme.name),isOnScreen:m})}}d("widgetOnScreen",c);d("widgetPool",c)}var f={},p="inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwitched isController hasVersionManager isThemeWidget supportMultiInstance mirrorIconForRTL".split(" ");f.visitElement=k;f.getConfigElementById=function(a,
c){var d;if("map"===c)return a.map;k(a,function(b){if(b.id===c)return d=b,!0});return d};f.getConfigElementByLabel=function(a,c){var d;if("map"===c)return a.map;k(a,function(b){if(b.label||b.name===c)return d=b,!0});return d};f.getConfigElementsByName=function(a,c){var d=[];if("map"===c)return[a.map];k(a,function(b){b.name===c&&d.push(b)});return d};f.getWidgetNameFromUri=function(a){a=a.split("/");a.pop();return a.pop()};f.getAmdFolderFromUri=function(a){a=a.split("/");a.pop();return a.join("/")+
"/"};f.widgetProperties=p;f.processWidgetProperties=function(a){"undefined"===typeof a.properties.isController&&(a.properties.isController=!1);"undefined"===typeof a.properties.isThemeWidget&&(a.properties.isThemeWidget=!1);"undefined"===typeof a.properties.hasVersionManager&&(a.properties.hasVersionManager=!1);"undefined"===typeof a.properties.mirrorIconForRTL&&(a.properties.mirrorIconForRTL=!1);p.forEach(function(c){"undefined"===typeof a.properties[c]&&(a.properties[c]=!0)})};f.getControllerWidgets=
function(a){var c=[];a.visitElement(function(d){d.isController&&c.push(d)});return c};f.isHostedService=function(a){var c=q.getServerByUrl(a);return(new RegExp(c+"/[^/]+/[^/]+/rest/services","gi")).test(a)};return f});