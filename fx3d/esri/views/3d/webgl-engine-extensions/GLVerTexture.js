//>>built
define(["dojo/_base/declare","../support/fx3dUtils"],function(e,d){var f=0;return e(null,{declaredClass:"esri.views.3d.webgl-engine-extensions.GLVerTexture",constructor:function(a){this.id=f++;this._gl=a;this._ready=!1;this._textureHandle=this._pixelDataType=this._pixelData=null;this._gl&&(this._textureHandle=this._gl.createTexture())},_setTexParams:function(){this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE);
this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST)},_reset:function(a,c){this._width=a;this._height=c;this._pixelSize=window.parseInt(this._width*this._height*4);(this._isPowerOfTwo=d.isPowerOfTwo(a)&&d.isPowerOfTwo(c))||(console.warn("Width and height are not power of 2, and the rendering may be incorrect."),
console.error("GLVerTexture ERROR 222"))},initTexture:function(a,c,b){if(b instanceof Uint8Array)this._pixelDataType=5121;else{if(!(b instanceof Float32Array))return;this._pixelDataType=5126}return this._reset(a,c),isNaN(this._pixelSize)||this._pixelSize!==b.length?(console.warn("The pixel size is invalid."),void console.error("GLVerTexture ERROR 333")):(this._gl.bindTexture(this._gl.TEXTURE_2D,this._textureHandle),this._setTexParams(),void this._texImage2D())},setData:function(a,c,b){if(b instanceof
Uint8Array)this._pixelDataType=5121;else{if(!(b instanceof Float32Array))return;this._pixelDataType=5126}return this._reset(a,c),isNaN(this._pixelSize)||this._pixelSize!==b.length?(console.warn("The pixel size is invalid."),void console.error("GLVerTexture ERROR 333")):(this._pixelData=b,this._gl.bindTexture(this._gl.TEXTURE_2D,this._textureHandle),this._setTexParams(),void this._texImage2D())},updateTexture:function(a){this._pixelData=a;this._gl.bindTexture(this._gl.TEXTURE_2D,this._textureHandle);
this._setTexParams();this._texImage2D();this._showError()},syncData:function(a){this._gl.bindTexture(this._gl.TEXTURE_2D,this._textureHandle);this._setTexParams();this._texImage2D();this._showError()},_showError:function(){var a=this._gl.getError();0!==a&&console.error("TEX Error \x3d\x3d\x3e "+a)},bind:function(a){return this._textureHandle?("number"==typeof a&&this._gl.activeTexture(33984+a),this._gl.bindTexture(3553,this._textureHandle),void this.syncData()):void console.error("GLVerTexture ERROR 444")},
unbind:function(){this._gl.bindTexture(3553,null)},release:function(){this._gl.bindTexture(3553,null)},getTextureHandle:function(){return this._textureHandle},dispose:function(){this._textureHandle.__deleted__=!0;this._gl.deleteTexture(this._textureHandle)},_texImage2D:function(){var a=this._gl.RGBA;this._gl instanceof WebGLRenderingContext||this._gl instanceof WebGL2RenderingContext&&(a=this._gl.RGBA32F);this._gl.texImage2D(this._gl.TEXTURE_2D,0,a,this._width,this._height,0,this._gl.RGBA,this._pixelDataType,
this._pixelData)}})});