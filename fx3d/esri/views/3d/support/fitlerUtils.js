//>>built
define(["dojo/_base/lang","esri/core/Collection"],function(n,p){var q=Object.prototype.hasOwnProperty,r=function(m,a){return a=a||{},a.queryObj=a.queryObj||null,a.queryFunc=a.queryFunc||null,this.collection=m,this.filteredrows=[],"undefined"!=typeof a.queryObj&&null!==a.queryObj?this.find(a.queryObj,a.firstOnly):"undefined"!=typeof a.queryFunc&&null!==a.queryFunc?this.where(a.queryFunc):(this._calculateRange=function(k,b,c){var g=[].concat(this.collection.toArray()),l=this.collection.binaryIndices[b].values,
d=0,e=l.length-1,f=0;if(0===g.length)return[0,-1];var h=g[l[d]][b];f=g[l[e]][b];switch(k){case "$eq":if(ltHelper(c,h,!1)||gtHelper(c,f,!1))return[0,-1];break;case "$dteq":if(ltHelper(c,h,!1)||gtHelper(c,f,!1))return[0,-1];break;case "$gt":if(gtHelper(c,f,!0))return[0,-1];break;case "$gte":if(gtHelper(c,f,!1))return[0,-1];break;case "$lt":if(ltHelper(c,h,!0))return[0,-1];if(ltHelper(f,c,!1))return[0,g.length-1];break;case "$lte":if(ltHelper(c,h,!1))return[0,-1];if(ltHelper(f,c,!0))return[0,g.length-
1]}for(;d<e;)f=d+e>>1,ltHelper(g[l[f]][b],c,!1)?d=f+1:e=f;h=d;for(e=l.length-1;d<e;)f=d+e>>1,ltHelper(c,g[l[f]][b],!1)?e=f:d=f+1;d=e;e=g[l[h]][b];b=g[l[d]][b];switch(k){case "$eq":return e!==c?[0,-1]:(b!==c&&d--,[h,d]);case "$dteq":return e>c||e<c?[0,-1]:((b>c||b<c)&&d--,[h,d]);case "$gt":return ltHelper(b,c,!0)?[0,-1]:[d,g.length-1];case "$gte":return ltHelper(e,c,!1)?[0,-1]:[h,g.length-1];case "$lt":return 0===h&&ltHelper(e,c,!1)?[0,0]:[0,h-1];case "$lte":return b!==c&&d--,0===d&&ltHelper(b,c,!1)?
[0,0]:[0,d];default:return[0,g.length-1]}},this.$and=function(k){for(var b=0;b<k.length&&0!=this.collection.length;b++)this._find(k[b]);return this},this.$or=function(k){this.collection.length},this)};return{findByConditions:function(m,a){if(!(m instanceof p))return console.warn("collection must be a instance of esri.core.Collection."),[];null==a&&(a="getAll");if(0!==m.length){var k;a={queryObj:a};if(n.isObject(a))for(k in a)if(q.call(a,k)){var b=k;break}b&&"getAll"!==a?("$and"===b||"$or"===b)&&(new r(m))[b](a).data():
[].concat(m.toArray())}}}});